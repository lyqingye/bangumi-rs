# 在线播放

Bangumi-rs 提供了便捷的在线播放功能，让你无需等待下载完成即可观看番剧，同时支持多种主流播放器。

## 播放功能概述

在线播放功能允许你：

- 直接播放已下载的番剧
- 使用你喜欢的外部播放器
- 记录观看历史和进度
- 享受流畅的观影体验

## 支持的播放器

Bangumi-rs 目前支持以下播放器：

### IINA (macOS)

[IINA](https://iina.io/) 是 macOS 上的现代化开源媒体播放器，具有美观的界面和强大的功能。

特点：

- 美观的原生 macOS 界面
- 强大的播放控制
- 支持多种字幕格式
- 硬件加速解码

### Infuse (iOS/macOS)

[Infuse](https://firecore.com/infuse) 是一款高品质的视频播放器，适用于 iOS 和 macOS 设备。

特点：

- 精美的界面设计
- 强大的格式支持
- 出色的字幕处理
- 跨设备同步

### 其他播放器

Bangumi-rs 也支持通过 URL 方式与其他播放器集成，只要播放器支持通过 URL 打开视频即可。

## 使用方法

### 播放单集

1. 在番剧详情页面找到已下载的剧集
2. 点击剧集旁边的 "播放" 按钮
3. 在弹出的播放器选择对话框中选择你偏好的播放器
4. 视频将在选择的播放器中打开

### 连续播放

1. 在番剧详情页面点击 "连续播放" 按钮
2. 选择起始剧集
3. 选择播放器
4. 系统将按顺序播放剧集，一集结束后自动播放下一集

### 播放历史

Bangumi-rs 会记录你的播放历史，包括：

- 最近观看的番剧
- 每部番剧的观看进度
- 上次观看的时间

你可以在 "播放历史" 页面查看和管理这些记录。

## 播放设置

在设置页面的 "播放设置" 选项卡中，你可以配置以下选项：

- **默认播放器**: 设置默认使用的播放器
- **自动播放下一集**: 启用/禁用自动播放下一集功能
- **记住播放位置**: 是否记住上次播放的位置
- **字幕设置**: 配置默认字幕语言和样式
- **播放质量**: 设置默认播放质量

## 技术实现

Bangumi-rs 的在线播放功能通过以下方式实现：

1. **本地媒体服务器**: 系统内置了一个轻量级媒体服务器
2. **URL 方案处理**: 通过特定的 URL 方案与外部播放器通信
3. **媒体索引**: 建立媒体文件索引，提供快速访问
4. **流式传输**: 支持视频流式传输，减少缓冲时间

## 播放流程

1. **用户请求**: 用户点击播放按钮
2. **媒体准备**: 系统准备媒体文件和元数据
3. **播放器启动**: 启动选定的外部播放器
4. **传输控制**: 将控制权和媒体 URL 传递给播放器
5. **播放监控**: 监控播放状态和进度
6. **记录历史**: 记录播放历史和进度

## 最佳实践

- **选择合适的播放器**: 根据你的设备和需求选择最适合的播放器
- **使用有线网络**: 对于高清视频，建议使用有线网络连接以获得最佳体验
- **定期清理缓存**: 定期清理播放缓存，保持系统流畅
- **更新播放器**: 保持外部播放器的更新，获取最新功能和修复

## 常见问题

- **播放器无法启动怎么办?**

  - 确认播放器已正确安装
  - 检查系统权限设置
  - 尝试重启应用程序

- **视频播放卡顿怎么办?**

  - 检查网络连接
  - 降低播放质量
  - 确认设备性能足够
  - 关闭其他占用资源的应用

- **字幕不显示怎么办?**

  - 确认视频文件包含字幕或有外挂字幕
  - 检查播放器的字幕设置
  - 尝试使用其他播放器

- **如何在不同设备间同步观看进度?**
  - 目前 Bangumi-rs 不直接支持跨设备同步
  - 可以考虑使用支持同步功能的播放器，如 Infuse Pro
