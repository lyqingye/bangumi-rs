# 元数据管理

元数据管理是 Bangumi-rs 的重要功能，它负责获取、存储和展示番剧的详细信息，为用户提供丰富的内容展示和管理体验。

## 元数据功能概述

Bangumi-rs 的元数据管理功能包括：

- 自动获取番剧信息
- 从多个数据源整合元数据
- 提供丰富的番剧展示
- 支持手动刷新和更新

## 数据来源

Bangumi-rs 支持从多个数据源获取元数据，确保信息的全面性和准确性：

### TMDB (The Movie Database)

[TMDB](https://www.themoviedb.org/) 是一个全球性的影视数据库，提供丰富的影视信息。

提供的数据：

- 番剧基本信息
- 海报和背景图
- 剧集列表和简介
- 评分和流行度
- 制作公司信息

### Bangumi.tv

[Bangumi.tv](https://bgm.tv/) 是一个专注于动漫、游戏的中文社区和数据库。

提供的数据：

- 番剧中文信息
- 精准的季度分类
- 社区评分
- 标签和分类
- 声优和工作人员信息

### Mikan

[Mikan](https://mikanani.me/) 是一个动漫资源站点，也提供基本的番剧信息。

提供的数据：

- 番剧基本信息
- 资源发布信息
- 字幕组信息

## 元数据内容

Bangumi-rs 管理的元数据包括以下内容：

### 基本信息

- **标题**: 包括原名、中文名、英文名等
- **简介**: 番剧的详细介绍
- **类型**: 如动画、电影、OVA 等
- **类别**: 如科幻、奇幻、校园等
- **首播日期**: 番剧的首播时间
- **状态**: 连载中、已完结等
- **评分**: 来自不同平台的评分

### 视觉资源

- **海报**: 番剧的主要海报图片
- **背景图**: 用于详情页背景的大图
- **剧照**: 番剧的场景截图
- **标志**: 番剧的标志和图标

### 剧集信息

- **剧集列表**: 所有剧集的编号和标题
- **剧集简介**: 每集的简要内容介绍
- **播出日期**: 每集的播出日期
- **时长**: 每集的播放时长

### 制作信息

- **制作公司**: 负责制作的动画公司
- **导演**: 番剧的导演信息
- **原作**: 原作者或原作作品
- **声优**: 主要角色的配音演员

## 使用方法

### 查看元数据

1. 在番剧详情页面可以查看完整的元数据信息
2. 在首页的番剧卡片上显示基本信息
3. 在搜索结果中展示简要信息

### 刷新元数据

1. 在番剧详情页面点击 "刷新元数据" 按钮
2. 系统将从配置的数据源重新获取最新信息
3. 更新完成后页面会自动刷新

### 手动编辑

1. 在番剧详情页面点击 "编辑信息" 按钮
2. 在编辑界面修改需要更新的信息
3. 点击 "保存" 按钮确认修改

## 元数据设置

在设置页面的 "元数据设置" 选项卡中，你可以配置以下选项：

- **数据源优先级**: 设置不同数据源的优先级
- **自动刷新**: 设置元数据的自动刷新频率
- **图片质量**: 设置下载的图片质量
- **语言偏好**: 设置元数据的首选语言
- **缓存设置**: 配置元数据缓存的大小和保留时间

## 技术实现

Bangumi-rs 的元数据管理通过以下方式实现：

1. **API 集成**: 与各数据源的 API 集成
2. **数据合并**: 智能合并来自不同来源的数据
3. **本地缓存**: 缓存元数据减少 API 请求
4. **增量更新**: 只更新变化的部分，提高效率
5. **图片优化**: 优化图片大小和格式，提高加载速度

## 元数据工作流程

1. **初始获取**: 添加番剧时自动获取基本元数据
2. **数据整合**: 从多个来源获取并整合数据
3. **本地存储**: 将元数据存储在本地数据库
4. **定期更新**: 根据设置定期检查和更新元数据
5. **用户界面**: 在界面上展示元数据

## 最佳实践

- **配置 API 密钥**: 为获取完整的元数据，建议配置 TMDB 的 API 密钥
- **合理设置刷新频率**: 避免过于频繁的刷新，减轻数据源负担
- **优先使用高质量数据源**: 对于重要的番剧，优先使用 TMDB 或 Bangumi.tv
- **定期清理缓存**: 清理不再需要的元数据缓存，节省存储空间

## 常见问题

- **元数据不完整怎么办?**

  - 尝试手动刷新元数据
  - 检查是否配置了所有数据源
  - 尝试更改数据源优先级
  - 手动编辑补充缺失信息

- **图片加载慢怎么办?**

  - 降低图片质量设置
  - 检查网络连接
  - 增加缓存大小
  - 考虑使用代理访问图片服务器

- **如何批量更新元数据?**
  - 在设置页面的 "元数据管理" 选项卡中可以执行批量更新操作
