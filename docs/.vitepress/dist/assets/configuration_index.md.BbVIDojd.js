import{_ as s,c as i,o as n,ag as t}from"./chunks/framework.Ckikgd0K.js";const c=JSON.parse('{"title":"配置概览","description":"","frontmatter":{},"headers":[],"relativePath":"configuration/index.md","filePath":"configuration/index.md","lastUpdated":1741430793000}'),e={name:"configuration/index.md"};function l(h,a,p,r,o,k){return n(),i("div",null,a[0]||(a[0]=[t(`<h1 id="配置概览" tabindex="-1">配置概览 <a class="header-anchor" href="#配置概览" aria-label="Permalink to &quot;配置概览&quot;">​</a></h1><p>Bangumi-rs 通过配置文件提供了丰富的自定义选项，让你可以根据自己的需求调整系统行为。本页面将概述配置文件的结构和主要配置项。</p><h2 id="配置文件位置" tabindex="-1">配置文件位置 <a class="header-anchor" href="#配置文件位置" aria-label="Permalink to &quot;配置文件位置&quot;">​</a></h2><p>默认情况下，Bangumi-rs 会在以下位置查找配置文件：</p><ul><li><strong>标准位置</strong>: <code>./config.toml</code>（与可执行文件同目录）</li><li><strong>Docker 环境</strong>: <code>/app/config.toml</code>（容器内路径）</li></ul><p>你也可以通过环境变量 <code>BANGUMI_CONFIG</code> 指定配置文件的路径：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> BANGUMI_CONFIG</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/path/to/your/config.toml</span></span></code></pre></div><h2 id="配置文件格式" tabindex="-1">配置文件格式 <a class="header-anchor" href="#配置文件格式" aria-label="Permalink to &quot;配置文件格式&quot;">​</a></h2><p>Bangumi-rs 使用 <a href="https://toml.io/" target="_blank" rel="noreferrer">TOML</a> 格式作为配置文件格式。TOML 是一种易于阅读和编写的配置文件格式，类似于 INI 但功能更强大。</p><p>配置文件由多个部分组成，每个部分对应系统的一个功能模块：</p><div class="language-toml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">toml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">section_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">key1 = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;value1&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">key2 = </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">section_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">subsection</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">key3 = </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span></code></pre></div><h2 id="配置示例" tabindex="-1">配置示例 <a class="header-anchor" href="#配置示例" aria-label="Permalink to &quot;配置示例&quot;">​</a></h2><p>以下是一个基本的配置文件示例：</p><div class="language-toml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">toml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">level = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;info&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">assets_path = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;./assets&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">listen_addr = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;127.0.0.1:3001&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">database_url = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;sqlite:bangumi.db&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mikan</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">endpoint = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://mikanani.me&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">downloader</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">max_retry_count = </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">download_dir = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/animes&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">proxy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">enabled = </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">http = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://127.0.0.1:7890&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">https = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://127.0.0.1:7890&quot;</span></span></code></pre></div><h2 id="主要配置部分" tabindex="-1">主要配置部分 <a class="header-anchor" href="#主要配置部分" aria-label="Permalink to &quot;主要配置部分&quot;">​</a></h2><p>Bangumi-rs 的配置文件包含以下主要部分：</p><h3 id="日志配置-log" tabindex="-1">日志配置 [log] <a class="header-anchor" href="#日志配置-log" aria-label="Permalink to &quot;日志配置 [log]&quot;">​</a></h3><p>控制日志输出级别和格式。</p><h3 id="服务器配置-server" tabindex="-1">服务器配置 [server] <a class="header-anchor" href="#服务器配置-server" aria-label="Permalink to &quot;服务器配置 [server]&quot;">​</a></h3><p>设置服务器监听地址、数据库连接和资源路径。</p><h3 id="资源站点配置-mikan-bangumi-tv-tmdb" tabindex="-1">资源站点配置 [mikan], [bangumi_tv], [tmdb] <a class="header-anchor" href="#资源站点配置-mikan-bangumi-tv-tmdb" aria-label="Permalink to &quot;资源站点配置 [mikan], [bangumi_tv], [tmdb]&quot;">​</a></h3><p>配置各个资源站点和元数据源的 API 端点和认证信息。</p><h3 id="解析器配置-parser" tabindex="-1">解析器配置 [parser.*] <a class="header-anchor" href="#解析器配置-parser" aria-label="Permalink to &quot;解析器配置 [parser.*]&quot;">​</a></h3><p>配置文件名解析器，包括传统解析器和 AI 解析器。</p><h3 id="下载器配置-downloader" tabindex="-1">下载器配置 [downloader] <a class="header-anchor" href="#下载器配置-downloader" aria-label="Permalink to &quot;下载器配置 [downloader]&quot;">​</a></h3><p>设置下载行为、重试策略和存储路径。</p><h3 id="通知配置-notify" tabindex="-1">通知配置 [notify.*] <a class="header-anchor" href="#通知配置-notify" aria-label="Permalink to &quot;通知配置 [notify.*]&quot;">​</a></h3><p>配置通知渠道和参数。</p><h3 id="代理配置-proxy" tabindex="-1">代理配置 [proxy] <a class="header-anchor" href="#代理配置-proxy" aria-label="Permalink to &quot;代理配置 [proxy]&quot;">​</a></h3><p>设置网络代理，用于访问被限制的资源。</p><h2 id="配置热重载" tabindex="-1">配置热重载 <a class="header-anchor" href="#配置热重载" aria-label="Permalink to &quot;配置热重载&quot;">​</a></h2><p>Bangumi-rs 支持配置热重载，这意味着你可以在不重启应用程序的情况下修改配置文件。系统会自动检测配置文件的变化并应用新的设置。</p><p>某些配置项（如数据库连接、监听地址等）需要重启应用程序才能生效。</p><h2 id="环境变量覆盖" tabindex="-1">环境变量覆盖 <a class="header-anchor" href="#环境变量覆盖" aria-label="Permalink to &quot;环境变量覆盖&quot;">​</a></h2><p>你可以使用环境变量覆盖配置文件中的设置。环境变量的命名规则为：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>BANGUMI_SECTION_KEY=value</span></span></code></pre></div><p>例如，要覆盖 <code>[server]</code> 部分的 <code>listen_addr</code> 设置，可以使用：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> BANGUMI_SERVER_LISTEN_ADDR</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;0.0.0.0:3001&quot;</span></span></code></pre></div><h2 id="敏感信息处理" tabindex="-1">敏感信息处理 <a class="header-anchor" href="#敏感信息处理" aria-label="Permalink to &quot;敏感信息处理&quot;">​</a></h2><p>配置文件可能包含敏感信息，如 API 密钥和认证令牌。建议：</p><ol><li>不要将包含敏感信息的配置文件提交到版本控制系统</li><li>使用环境变量或密钥管理系统管理敏感信息</li><li>限制配置文件的访问权限</li></ol><h2 id="下一步" tabindex="-1">下一步 <a class="header-anchor" href="#下一步" aria-label="Permalink to &quot;下一步&quot;">​</a></h2><p>查看以下页面了解各个配置部分的详细说明：</p><ul><li><a href="/bangumi-rs/configuration/server.html">服务器配置</a>: 服务器和数据库设置</li><li><a href="/bangumi-rs/configuration/sites.html">资源站点配置</a>: 资源站点和元数据源配置</li><li><a href="/bangumi-rs/configuration/parser.html">解析器配置</a>: 文件名解析器配置</li><li><a href="/bangumi-rs/configuration/downloader.html">下载器配置</a>: 下载行为和存储配置</li><li><a href="/bangumi-rs/configuration/notification.html">通知配置</a>: 通知渠道和参数</li><li><a href="/bangumi-rs/configuration/proxy.html">代理配置</a>: 网络代理设置</li></ul>`,44)]))}const E=s(e,[["render",l]]);export{c as __pageData,E as default};
